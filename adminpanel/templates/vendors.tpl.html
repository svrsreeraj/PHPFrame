{assign var="actionReturn" value=$obj->actionReturn}
{literal}
<script type="text/javascript">

function getStates(cid,changeId)
	{
		$("#"+changeId).html("Loading...");
		$.ajax({
			   type	: "GET",
			   url	: "vendors.php",
			   data	: "actionvar=Getstatecombo&cid="+cid,
			   dataType: "html",
			   success: function(msg){
				   $("#"+changeId).html(msg);
				}
			 });
	}
function getcombo(cid,changeId)
	{
		$.ajax({
			   type	: "GET",
			   url	: "vendors.php",
			   data	: "actionvar=Getcombo&id="+cid,
			   dataType: "html",
			   success: function(msg){
				   $("#"+changeId).html(msg);
				}
			 });
	}
$(document).ready(function() {
	$("#vendor").tooltip();
	$("#runningdeal").tooltip();
	$("#rejecteddeal").tooltip();
	$("#cooldown").tooltip();
	$("#unlocked").tooltip();
	$("#lockeddeal").tooltip();
	$("#queueddeal").tooltip();
	$("#Expired").tooltip();
	$("#totalcomm").tooltip();
	$("#balancecomm").tooltip();
	$("#totalEarned").tooltip();
	
	$("#txt_join_from").datepicker();
	$("#txt_join_from").datepicker('option',
	{
		showAnim:'show',
		dateFormat:'yy-mm-dd',
		changeMonth: true,
		changeYear: true,
		//minDate: -20, 
		//maxDate: '+1M +10D',
		showOtherMonths: true, 
		selectOtherMonths: true,
		//yearRange:'c-50:c+10',
		autoSize:false
	});

$("#txt_join_to").datepicker();
	$("#txt_join_to").datepicker('option',
	{
		showAnim:'show',
		dateFormat:'yy-mm-dd',
		changeMonth: true,
		changeYear: true,
		//minDate: -20, 
		//maxDate: '+1M +10D',
		showOtherMonths: true, 
		selectOtherMonths: true,
		//yearRange:'c-50:c+10',
		autoSize:false
	});

});
</script>

<link type="text/css" href="js/ui/themes/base/jquery.ui.all.css" rel="stylesheet" />
<script type="text/javascript" src="js/ui/ui/jquery.ui.core.js"></script>
<script type="text/javascript" src="js/ui/ui/jquery.ui.widget.js"></script>
<script type="text/javascript" src="js/ui/ui/jquery.ui.datepicker.js"></script>

{/literal}


<table width="100%" border="0" cellpadding="0" cellspacing="0" class="table_style">
{if $obj->getPageError()}
<tr>
	<td class="errorMessage">{$obj->popPageError()}</td>
</tr>
{/if}
<tr>
	<td class="pageHead"><span id="vendor"><strong>Vendor {if ($obj->currentAction	==	"Listing")}Listing{/if} {if ($obj->currentAction	==	"Editform")}Edit : {$actionReturn.data.business_name}  {/if} </strong>
</span></td></tr>
{if ($obj->currentAction	==	"Editform")}
{if $obj->permissionCheck("Edit")}                                                     
<tr>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>
	<form action="" name="fromName" method="post" enctype="multipart/form-data">
		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="formTable">
			<tr>
				
			</tr>
			<tr>
				<td width="150">Sales Agent</td>
				<td>{$actionReturn.combo}</td>
			</tr>
			<tr>
				<td>Business Name </td>
				<td><input type="text" valtype="emptyCheck-Please enter your bussiness name" name="business_name" value="{$actionReturn.data.business_name}" id="business_nameId"  />
				</td>
			</tr>
			<tr>
				<td>Email</td>
				<td><input type="text" valtype="emptyCheck-Please enter your Email|emailCheck-Please enter a valid Email" name="email" value="{$actionReturn.data.email}" id="emailId" class="emailValidate" /></td>
			</tr>
			<tr>
				<td>Contact Person </td>
				<td><input type="text"  name="contact_person" valtype="emptyCheck-Please enter the contact person" value="{$actionReturn.data.contact_person}" id="contact_personId" class="alphaNumeric" /></td>
			</tr>
			<tr>
				<td>Password</td>
				<td><input type="password"  name="password" valtype="emptyCheck-Please enter a password" value="{$actionReturn.data.password}" id="passwordId" /></td>
			</tr>
		
			<tr>
				<td>Address</td>
				<td><textarea  name="address" id="addressId" valtype="emptyCheck-Please enter an Address " class="validateText">{$actionReturn.data.address} </textarea></td>
			</tr>
			<tr>
				<td>City</td>
				<td><input type="text" name="city" value="{$actionReturn.data.city}" id="cityId"  />
				</td>
			</tr>
			<tr>
				<td>Country</td>
				<td>{$actionReturn.country_combo}</td>
			</tr>
	
			<tr>
				<td>State</td>
				<td><div id="stateDivId">{$actionReturn.country_state}</div></td>
			</tr>	
			
			<tr>
				<td>Zip</td>
				<td><input type="text" valtype="emptyCheck-Please enter your zipcode"  name="zip" value="{$actionReturn.data.zip}" id="zipId" class="validatezip" maxlength="7" /></td>
			</tr>
		
			<tr>
				<td>Mobile</td>
				<td><input type="text"  name="mobile"  value="{$actionReturn.data.mobile}" id="mobileId" class="nummberOnly"  maxlength="15"/></td>
			</tr>
			<tr>
				<td>Phone </td>
				<td><input type="text"  name="phone" valtype="emptyCheck-Please enter the phone number|checkNumber-please enter a valid phone number" value="{$actionReturn.data.phone}" id="phoneId" class="nummberOnly"  maxlength="15"/></td>
			</tr>
			<tr>
				<td>Latitude</td>
				<td><input type="text"  name="latitude" value="{$actionReturn.data.latitude}" id="latitudeId" /></td>
			</tr>
	
			<tr>
				<td>Longitude</td>
				<td><input type="text"  name="longitude" value="{$actionReturn.data.longitude}" id="longitudeId"  /></td>
			</tr>
			
			<tr>
				<td>Website</td>
				<td><input type="text"  name="website" value="{$actionReturn.data.website}" id="websiteId"  /></td>
			</tr>
		
		
			<!--<tr>
				<td>Tax</td>
				<td><input type="text" valtype="emptyCheck-Please enter the tax percentage" name="tax" value="{$actionReturn.data.tax}" id="taxId" class="nummberOnly" maxlength="3"  /></td>
			</tr>-->
			<tr>
				<td>Products</td>
				<td>{$actionReturn.combo_products}</td>
			</tr>
			<tr>
				<td>Industries</td>
				<td>{$actionReturn.combo_industries}</td>
			</tr>
	
			<tr>
				<td>Email Update</td>
				<td>
				<input type="checkbox"  name="email_update"  id="email_updateId" value="1"  
				{if $actionReturn.data.email_update	=='1'}  checked="checked" {/if}/>
				</td>
			</tr>
	
			<tr>
				<td>SMS Update</td>
				<td><input type="checkbox"  name="sms_update"  id="sms_updateId" value="1" 
				{if $actionReturn.data.sms_update=='1'} checked="checked"  {/if}/> </td>
			</tr>
				<td>&nbsp;</td>
				<td>
				{if $obj->currentAction	==	"Editform"}
					{if $obj->permissionCheck("Edit")}
					<input type="submit" class="butsubmit" valcheck="true" name="actionvar" value="Update" id="saveDataId" />
					{/if}
				{else}
					{if $obj->permissionCheck("Add")}
					<input type="submit" class="butsubmit" valcheck="true" name="actionvar" value="Save" id="saveDataId" />
					{/if}
				{/if}
					<input type="submit" class="butsubmit"  name="actionvar" value="Cancel" id="cancelId" />
				</td>
			</tr>
		</table>
			</form>
	</td>
</tr>
{/if}	
{/if}


{if ($obj->currentAction	==	"Viewform")}
{if $obj->permissionCheck("View")}                                                     
<tr>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>
		<form action="" name="fromName" method="post" enctype="multipart/form-data" >
			<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="formTable">
				<tbody>
					<tr>
						<td width="50%">
							<div class="boxList" >
								<table width="340" border="0" align="center" cellpadding="0" cellspacing="0" class="listTablePopUp">
									<tr>
										<th colspan="3">Vendor Personal Profile</th>
									</tr>
								
								{if $actionReturn.data.business_name}
									<tr>
										<td>Busines Name </td>
										<td>{$actionReturn.data.business_name}</td>
									</tr>
								{/if}
								{if $actionReturn.data.salesagent<>0}
									<tr><td>Sales Agent</td>
										<td>{$actionReturn.salesagent.salesagent}</td>
									</tr>
								{/if}
								{if $actionReturn.data.email}
									<tr>
									<td>Email</td>
									<td>{$actionReturn.data.email}</td>
									</tr>
								{/if}
								{if $actionReturn.data.contact_person}
									<tr>
										<td>Contact Person </td>
										<td>{$actionReturn.data.contact_person}</td>
									</tr>
								{/if}
								{if $actionReturn.data.password}
								<tr>
									<td>Password</td>
									<td>{$actionReturn.data.password}</td>
								</tr>
								{/if}
								{if $actionReturn.data.address}
								<tr>
									<td>Address</td>
									<td>{$obj->nl2br($actionReturn.data.address)}</td>
								</tr>
								{/if}
									{if $actionReturn.country_combo}
								<tr>
									<td>Country</td>
									<td>{$actionReturn.country_combo}</td>
								</tr>
								{/if}
								{if $actionReturn.country_state}
								<tr>
									<td>State</td>
									<td>{$actionReturn.country_state}</td>
								</tr>	
								{/if}
								{if $actionReturn.city}
								<tr>
									<td>City</td>
									<td>{$actionReturn.city}</td>
								</tr>	
								{/if}
								{if $actionReturn.data.zip}
								<tr>
									<td>Zip</td>
									<td>{$actionReturn.data.zip}</td>
								</tr>
								{/if}
								{if $actionReturn.data.phone}
								<tr>
									<td>Phone</td>
									<td>{$obj->getUSPhoneDisplay($actionReturn.data.phone)}</td>
								</tr>
								{/if}
								{if $actionReturn.data.mobile}
								<tr>
									<td>Mobile</td>
									<td>{$obj->getUSPhoneDisplay($actionReturn.data.mobile)}</td>
								</tr>
								{/if}
								{if $actionReturn.data.date_added > 0}
								<tr>
									<td>Date Added</td>
									<td>{$obj->displayDate($actionReturn.data.date_added)}</td>
									
								</tr>
								{/if}
								{if $actionReturn.data.latitude}
								<tr>
									<td>Latitude</td>
									<td>{$actionReturn.data.latitude}</td>
								</tr>
								{/if}
								{if $actionReturn.data.longitude}
								<tr>
									<td>Longitude</td>
									<td>{$actionReturn.data.longitude}</td>
								</tr>
								{/if}
								{if $actionReturn.data.website}
								<tr>
									<td>Website</td>
									<td>{$actionReturn.data.website}</td>
								</tr>
								{/if}
								{if $actionReturn.data.twitter_link}
								<tr>
									<td>Twitter Link</td>
									<td>{$actionReturn.data.twitter_link}</td>
								</tr>
								{/if}
								{if $actionReturn.data.fb_link}
								<tr>
									<td>Facebook Fan Page Link</td>
									<td>{$actionReturn.data.fb_link}</td>
								</tr>
								{/if}
								{if $actionReturn.data.tax}
								<tr>
									<td>Tax</td>
									<td>{$actionReturn.data.tax}</td>
								</tr>
								{/if}
								<tr>
									<td>Email Update</td>
									<td>{if $actionReturn.data.email_update==1 }Yes{else} No  {/if}</td>
								</tr>
								<tr>
									<td>SMS Update</td>
									<td>{if $actionReturn.data.sms_update==1 }Yes  {else} No {/if} </td>
								</tr>
								
								{if $actionReturn.combo_products}
								<tr>
									<td>Intrested products</td>
									<td>{$actionReturn.combo_products}</td>
								</tr>
								{/if}
								{if $actionReturn.combo_industries}
								<tr>
									<td>Intrested Industries</td>
									<td>{$actionReturn.combo_industries}</td>
								</tr>
								{/if}
								</table>
							
							
							</div>
						</td>
						<td width="50%">
							<div class="boxList" >
										<table width="340" border="0" align="center" cellpadding="0" cellspacing="0" class="listTablePopUp">		
											{if $actionReturn.deal_details}
											<tr>
												<th colspan="3">Deals</th>
											</tr>
											{foreach from=$actionReturn.deal_details item=data name=i}
												{foreach from=$data item=data2 name=i}
													{/foreach}
												<tr>
													<td><span id="runningdeal">Running Deals</span></td>
													<td>{$data.running}</td>
													<td>
													{if $data.running > 0}
													<a class="view-more" href="{$obj->getLink('Viewrunningdeal','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
													{/if}
													</td>
												</tr>
												<tr>
													<td><span id="rejecteddeal">Rejected Deals</span></td>
													<td>{$data.rejected}</td>
													<td>
													{if $data.rejected > 0}
													<a class="view-more" href="{$obj->getLink('ViewRejecteddeal','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
													{/if}
													</td>
												</tr>
												<tr>
													<td><span id="queueddeal">Queued Deals</span></td>
													<td>{$data.queued}</td>
													<td>
													{if $data.queued > 0}
													<a class="view-more" href="{$obj->getLink('Viewqueueddeal','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
													{/if}
													</td>
												</tr>
												<tr>
													<td><span id="cooldown">Cooldown Deals</span></td>
													<td>{$data.cooldown}</td>
													<td>
													{if $data.cooldown > 0}
													<a class="view-more" href="{$obj->getLink('Viewcooldowndeal','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}"target="window_name">View More</a>
													{/if}
													</td>
												</tr>
												<tr>
													<td><span id="lockeddeal">Locked Deals</span></td>
													<td>{$data.locked}</td>
													<td>
													{if $data.locked > 0}
													<a  class="view-more" href="{$obj->getLink('Viewlockeddeal','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
													{/if}
													</td>
												</tr>
												<tr>
													<td><span id="unlocked">Unlocked Deals</span></td>
													<td>{$data.unlocked}</td>
													<td>
													{if $data.unlocked > 0}
													<a class="view-more" href="{$obj->getLink('ViewUnlockeddeal','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
													{/if}
													</td>
												</tr>
												<tr>
													<td><span id="Expired">Expired Deals</span></td>
													<td>{$data.expired}</td>
													<td>
													{if $data.expired > 0}
													<a  class="view-more" href="{$obj->getLink('Viewexpireddeal','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
													{/if}
													</td>
												</tr>
											{/foreach}
										{/if}
											
										</table>
							
							<div class="boxList" >
							{if $actionReturn.vendor_payment}
							<table width="340" border="0" align="center" cellpadding="0" cellspacing="0" class="listTablePopUp">
								
								
									<th colspan="3">Payment Details</th>
										
										<tr>
											<td><span id="totalcomm">Total Commision</span></td><td>{$actionReturn.vendor_payment.total_comm_vendor}</td>		
											<td>
											{if $actionReturn.vendor_payment.total_comm_vendor >0}
											<a class="view-more" href="{$obj->getLink('Viewtotalcommision','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
											{/if}
											</td>
										</tr>
										<tr>
											<td><span id="balancecomm">Balance Commision</span></td><td>{$actionReturn.vendor_payment.balance_comm_vendor}</td>
											<td>
											{if $actionReturn.vendor_payment.balance_comm_vendor >0}
											<a class="view-more" href="{$obj->getLink('Viewbalancecommision','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
											{/if}
											</td>
										</tr>
										<tr>
											<td><span id="totalEarned">Total Earned Commision</span></td><td>{$actionReturn.vendor_payment.total_earned_comm_vendor}</td>		
											<td>
												{if $actionReturn.vendor_payment.total_earned_comm_vendor >0}
											<a class="view-more" href="{$obj->getLink('Viewtotalearnedcommision','vendors.php',true,$obj->getConcat('id=',$actionReturn.data.id))}" target="window_name">View More</a>
											{/if}
											</td>
										</tr>
									</table>
									{/if}
								</div>
						</td>	
						</tr>
				
			<tr>	<td>&nbsp;</td>
				<td>
					<input type="submit" class="butsubmit"  name="actionvar" value="Back" id="cancelId" />
				</td>
			</tr>
			
		</table>
		</form>
	</td>
</tr>
{/if}	
{/if}

{if $obj->permissionCheck("View")}
<tr>
	{if $obj->currentAction	==	"Listing"}
	<td>
		<table cellpadding="0" cellspacing="0" border="0" width="100%">
			<tr>
				<td  align="right">&nbsp;</td>
			</tr>
				
			<tr>
				{include file="vendorsearch.tpl"}
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
			{if $actionReturn.data}
			<tr>
				<td align="center" valign="middle">
					<table width="100%" border="0" cellpadding="0" cellspacing="0" class="listTable">
						<tr align="center" valign="middle">							
							<th>No</th>
							<th>ID</th>
								<th>
								<a href="{$obj->getLink('Search','',false)}&sortField=business_name&sortMethod={$obj->getNegativeSort($actionReturn.searchdata.sortData.sortMethod)}">
								Business Name
								{$obj->getSortImage('business_name',$actionReturn.searchdata.sortData.sortField,$actionReturn.searchdata.sortData.sortMethod)}
								</a>
							</th>	
								<th>
								<a href="{$obj->getLink('Search','',false)}&sortField=email&sortMethod={$obj->getNegativeSort($actionReturn.searchdata.sortData.sortMethod)}">
								Email
								{$obj->getSortImage('email',$actionReturn.searchdata.sortData.sortField,$actionReturn.searchdata.sortData.sortMethod)}
								</a>
							</th>	
							<th>
								<a href="{$obj->getLink('Search','',false)}&sortField=mobile&sortMethod={$obj->getNegativeSort($actionReturn.searchdata.sortData.sortMethod)}">
								Mobile
								{$obj->getSortImage('mobile',$actionReturn.searchdata.sortData.sortField,$actionReturn.searchdata.sortData.sortMethod)}
								</a>
							</th>	
							<th>
								<a href="{$obj->getLink('Search','',false)}&sortField=date_added&sortMethod={$obj->getNegativeSort($actionReturn.searchdata.sortData.sortMethod)}">
								Joining Date
								{$obj->getSortImage('date_added',$actionReturn.searchdata.sortData.sortField,$actionReturn.searchdata.sortData.sortMethod)}
								</a>
							</th>		
							<th colspan="6" >Action </th>

						</tr>
					{foreach from=$actionReturn.data item=data name=i}
						<tr>
							<td>{$actionReturn.spage->startingRow+$smarty.foreach.i.index}</td>
							<td>{$data.id}</td>
							<td><span title="{$data.business_name}" >{$obj->getLimitedText($data.business_name,25)}</span>
							</td>
							<td><span title="{$data.email}" >{$obj->getLimitedText($data.email,30)}</span>
							</td>
							<td>{$data.mobile }</td>
							<td>{$obj->displayDate($data.date_added) }</td>
							<td>
							
							
								{if $obj->permissionCheck("Status")}
								<a href="{$obj->getLink('Stauschange','',true,$obj->getConcat('id=',$data.id))}" class="Second_link">
								{/if}
										{if $data.status == 1} 
										<img src="images/active.gif" border="0" title="Click here to inactivate">
										 {else} 							 
										 <img src="images/inactive.gif" border="0" title="Click here to activate">
										 {/if}
								{if $obj->permissionCheck("Status")}
								 </a> 
								{/if}
					
							</td>
							<td>
								{if $obj->permissionCheck("View")}
								<a href="{$obj->getLink('viewform','',true,$obj->getConcat('id=',$data.id))}" class="Second_link">
								<img src="images/view.gif" border="0"  title="Click here to view"> </a>
								{/if}
							
							</td>
							<td>
								{if $obj->permissionCheck("Edit")}
								<a href="{$obj->getLink('editform','',true,$obj->getConcat('id=',$data.id))}" class="Second_link">
								<img src="images/edit.gif" border="0" title="Click here to edit"></a> 
								{/if}
							</td>
							
							<td>
							
								{if $obj->permissionCheck("Delete")}
								<a href="{$obj->getLink('deleteform','',true,$obj->getConcat('id=',$data.id))}" class="Second_link">
								<img src="images/delete.gif" border="0" title="Click here to delete"> </a>
								{/if}
							</td>
							<td>
							
								{if $data.vendorPost}							
								<a href="{$obj->getLink('Dealpost','',true)}&id={$data.id}" class="Second_link"  title="Click here to post new deal">
								Deal </a>
								{else} <span title="Sorry! This vendor is not allowed to post any deals at this time"> ---
								{/if}
							</td>
							<td>
							
								{if $data.vendorPays}							
								<a href="{$obj->getLink('Commisionpay','',true)}&id={$data.id}" class="Second_link"  title="Click here to make payment">
								Pay </a>
								{else} <span title="Sorry! This vendor have no expired or cooldown deals"> ---{/if}
								
							
							</td>
						</tr>
					{/foreach}
					<tr>
	<td colspan="12">{$actionReturn.spage->s_get_links()}</td>
					</tr>
				</table>
				</td>
			</tr>
		{/if}
		
		</table>
	</td>
	{/if}
</tr>
{/if}
</table>


{include_php file="footer.php"}
