<script type="text/javascript" src="../libs/ckeditor_3.5.1/ckeditor.js"></script>
{assign var="actionReturn" value=$obj->actionReturn}
<form action="" name="formName" method="post" enctype="multipart/form-data" id="bulkemail">
<table width="100%" border="0" cellpadding="0" cellspacing="0" class="table_style">
<tr>
	<td class="pageHead"><strong>Bulk Email Templates </strong></td>
</tr>

{if $obj->getPageError()}
<tr>
	<td class="errorMessage">{$obj->popPageError()}</td>
</tr>
{/if}


{if ($obj->currentAction	==	"Addform")	||	($obj->currentAction	==	"Editform")}
<tr>
	<td>&nbsp;</td>
</tr>
<tr>
	<td>

		<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="formTable">
			<tr>
				<th colspan="2">Manage Template</th>
			</tr>
			
			<tr>
				<td width="150">Template Category</td>
				<td>{$actionReturn.data.tempcombo}</td>
			</tr>
		
			<tr>
				<td width="150">Subject</td>
				<td><input type="text" name="title" valtype="emptyCheck-please enter a title"  value="{$actionReturn.data.title}" id="captionId" size="50" class="validateText"/></td>
			</tr>
			<tr>
				<td>Template</td>
				<td>
				{*$obj->get_fck("template",$actionReturn.data.template)*}
				<textarea name="template" cols="75" rows="50" id="template">{$actionReturn.data.template}</textarea>
				</td>
			</tr>
			
			<tr>
				<td>&nbsp;</td>
				<td>
				{if $obj->currentAction	==	"Editform"}
					<input type="submit" valcheck="true" class="butsubmit"  name="actionvar" value="Update" id="saveDataId" />
				{else}
					<input type="submit" valcheck="true" class="butsubmit"  name="actionvar" value="Save" id="saveDataId" />
				{/if}
					<input type="submit" class="butsubmit"  name="actionvar" value="Cancel" id="cancelId" />
				</td>
			</tr>
		</table>
	
	</td>
</tr>	
{/if}

{if $obj->permissionCheck("View")}
<tr>
	{if $obj->currentAction	==	"Listing"}
	<td>
		<table cellpadding="0" cellspacing="0" border="0" width="100%">
			<tr>
				<td  align="right">&nbsp;</td>
			</tr>
			
			<tr>
				<td>
			
					<table width="100%" border="0" align="center" cellpadding="0" cellspacing="0" class="searchTable">
						<tr>
						<td> <strong> {$actionReturn.spage->startingRow} - {$actionReturn.spage->endingRow}  </strong> of <strong>{$actionReturn.spage->totcnt} </strong> </td>							
						<td>Template Category:</td>
							<td>
								{$actionReturn.searchdata.searchCombo}
							</td>
							<td>
							<input type="text" name="keyword" maxlength="25" id="id_keyword" value="{$actionReturn.searchdata.keyword}" />
							</td>
							
							<td>
								<input name="actionvar" type="submit" class="butsubmit" value="Search" />
							</td>
							<td>
							<input name="actionvar" type="submit" class="butsubmit" value="Reset" />
							</td>
							<td>							
							{if $obj->permissionCheck("Add")}
							<input name="actionvar" type="submit" class="butsubmit" value="Add New" />
							{/if}
							</td>
						</tr>
					</table>
					
				</td>
			</tr>
			<tr>
				<td>&nbsp;</td>
			</tr>
			{if $actionReturn.data}
			<tr>
				<td align="center" valign="middle">
				
					<table width="100%" border="0" cellpadding="0" cellspacing="0" class="listTable">
						<tr align="center" valign="middle">							
							<th>No</th>
							<th>
								<a href="{$obj->getLink('Search','',false)}&sortField=temp_cat_id&sortMethod={$obj->getNegativeSort($actionReturn.searchdata.sortData.sortMethod)}">
								Category
								{$obj->getSortImage('temp_cat_id',$actionReturn.searchdata.sortData.sortField,$actionReturn.searchdata.sortData.sortMethod)}
								</a>
							</th>
							<th>
								<a href="{$obj->getLink('Search','',false)}&sortField=title&sortMethod={$obj->getNegativeSort($actionReturn.searchdata.sortData.sortMethod)}">
								Subject
								{$obj->getSortImage('title',$actionReturn.searchdata.sortData.sortField,$actionReturn.searchdata.sortData.sortMethod)}
								</a>
							</th>
							
							<th>
								<a href="{$obj->getLink('Search','',false)}&sortField=template&sortMethod={$obj->getNegativeSort($actionReturn.searchdata.sortData.sortMethod)}">
								Template
								{$obj->getSortImage('template',$actionReturn.searchdata.sortData.sortField,$actionReturn.searchdata.sortData.sortMethod)}
								</a>
							</th>
							<th>Action </th>

						</tr>
					{foreach from=$actionReturn.data item=data name=i}
						<tr>
							<td>{$actionReturn.spage->startingRow+$smarty.foreach.i.index}</td>
							<td>{$obj->checkfields('vod_bulk_email_tpl_category','id',$data.temp_cat_id,'category')}</td>
							<td>{$obj->getLimitedText($data.title,100)}</td>
							<td>{$obj->getLimitedText($data.template,60)|strip_tags}</td>
							<td>
							{if $obj->permissionCheck("Status")} 
<a href="{$obj->getLink('Statuschange','',true,$obj->getConcat('id=',$data.id,'&status=',$data.status))}" class="Second_link">
							{if $data.status == 1} 
							<img src="images/active.gif" border="0" title="Click here to inactivate">
							 {else} 							 
							 <img src="images/inactive.gif" border="0" title="Click here to activate">
							 {/if}
							 </a> 
							{/if}
							{if $obj->permissionCheck("Edit")} 
							<a href="{$obj->getLink('editform','',true,$obj->getConcat('id=',$data.id))}" class="Second_link"> <img src="images/edit.gif" border="0" title="Click here to edit"></a> 
							{/if} 
							<!--{if $obj->permissionCheck("Delete")}
							<a href="#" class="Second_link"><img src="images/delete.gif" border="0" title="Click here to delete"> </a>
							{/if}-->
							</td>
						</tr>
					{/foreach}
					<tr>
						<td colspan="6">{$actionReturn.spage->s_get_links()}</td>
					</tr>
				</table>
				</td>
			</tr>
		{/if}
		
		</table>
	</td>
	{/if}
</tr>
{/if}
</table>
	</form>
{literal}
<script type="text/javascript">
CKEDITOR.replace('template');
</script>
<script type="text/javascript">

$('#bulkemail').submit(function() {
var txt = $("#template").val();
});

</script>
{/literal}

{include_php file="footer.php"}
